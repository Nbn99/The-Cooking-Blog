<main>
  <% if (errorMessage) { %>
  <div class="user-message user-message--error"><%= errorMessage %></div>
  <% } %>
  <div class="container">
    <form
      action="/articles/<% if (editing) { %>edit<% } else { %>new<% } %>"
      method="POST"
      enctype="multipart/form-data"
    >
      <div class="form-group mb-2">
        <label for="title">Title</label>
        <input
          class="<%= validationErrors.find(e => e.param === 'title') ? 'invalid' : '' %> form-control"
          type="text"
          name="title"
          id="title"
          value="<% if (editing || hasError) { %><%= article.title %><% } %>"
        />
      </div>

      <div class="multiple_select">
        <input type="checkbox" class="toggle" id="toggle" checked />
        <label for="toggle" class="toggle_label">
          
          Category <span class="v">v</span>
        </label>

        <div class="select">
          <% if(categories != '') { %>
           <% categories.forEach(function (category,
          index) { %>
          <div class="option">
            <input type="checkbox" class="category" id="category"  name="category" value="<%= category.name %> "/>
            <label for="category"><%= category.name %></label>
            <input name="category_hidden" type="hidden" value="">
          </div>
          <% }) %> <% } else { %>
          <input type="checkbox" class="toggle" id="toggle" checked />
          <label for="toggle" class="toggle_label"> Must add Category</label>
          <a href="/categories/new" class="btn btn-secondary">Add category</a>
          <% } %>
        </div>
      </div>

      <div class="form-control mb-2">
        <label for="image">Image</label>
        <input class="form-control" type="file" name="image" id="image" />
      </div>

      <div class="form-control col-12">
        <label for="name" class="form-label">Ingredients</label><br />
        <div class="ingredientList" id="ingredientList">
        </div>
      </div>

      <div class="col-12 mb-2"> 
        <button
          type="button"
          class="btn btn-outline-primary"
          id="addIngredientsBtn"
        >
          + Ingredient
        </button>
      </div>

      <div class="form-group mb-2">
        <label for="description">Description</label>
        <textarea
          class="<%= validationErrors.find(e => e.param === 'description') ? 'invalid' : '' %> form-control"
          name="description"
          id="description"
          rows="5"
        >
      <% if (editing || hasError) { %><%= article.description %><% } %>
      </textarea>
      </div>

      <% if (editing) { %>
      <input type="hidden" value="<%= article._id %>" name="articleId" />
      <% } %>

      <a href="/articles" class="btn btn-secondary">Cancel</a>
      <button class="btn btn-primary" type="submit">
        <% if (editing) { %>Update Article<% } else { %>Add Article<% } %>
      </button>
    </form>
  </div>
</main>
